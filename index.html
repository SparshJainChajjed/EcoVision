<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Custom E-Waste Classifier</title>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
  <style>
    body { font-family: sans-serif; text-align:center; padding:2rem;}
    #preview { max-width: 100%; margin-top:1rem; }
    #label   { margin-top:1rem; font-size:1.5rem; }
  </style>
</head>
<body>
  <h1>E-Waste Classifier</h1>
  <p>Upload a photo of your gadget:</p>
  <input type="file" id="upload" accept="image/*">
  <img id="preview" src="" alt="Preview…">
  <div id="label">Model loading…</div>

  <script type="module">
    import * as tmImage from "https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js";

    const URL = "./model/";  // the folder you unzipped
    let model, maxPredictions;

    // 1️⃣ load your custom model
    tmImage.load(URL + "model.json", URL + "metadata.json").then(m => {
      model = m;
      maxPredictions = m.getTotalClasses();
      document.getElementById("label").innerText = "Model loaded - select an image!";
    });

    // 2️⃣ when user picks a file…
    document.getElementById("upload").addEventListener("change", async e => {
      const file = e.target.files[0];
      if (!file || !model) return;

      // show preview
      const imgEl = document.getElementById("preview");
      imgEl.src = URL.createObjectURL(file);
      await imgEl.decode();

      // run prediction
      const predictions = await model.predict(imgEl);
      // find best class
      predictions.sort((a,b)=>b.probability - a.probability);
      const top = predictions[0];

      // display result
      document.getElementById("label").innerText =
        `${top.className} — ${(top.probability*100).toFixed(1)}%`;
    });
  </script>
</body>
</html>
