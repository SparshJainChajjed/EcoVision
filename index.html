<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>E-Waste CV Check</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#0b0f14;--card:#121821;--muted:#8aa0b6;--text:#e8f1ff;--accent:#58d68d;--accent2:#20b2aa}
body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#0b0f14,#0c1117 40%,#0b0f14);color:var(--text);min-height:100vh;display:flex;flex-direction:column}
header{padding:18px 16px;background:rgba(9,13,19,.6);backdrop-filter:saturate(140%) blur(8px);border-bottom:1px solid rgba(255,255,255,.06)}
main{width:min(980px,92%);margin:24px auto 42px;display:grid;gap:18px}
.card{background:#121821;border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:18px;box-shadow:0 6px 18px rgba(0,0,0,.25)}
h1{font-size:20px}
h2{font-size:22px;margin-bottom:8px}
.note{color:var(--muted);font-size:14px;margin-top:8px}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.button{display:inline-block;padding:12px 16px;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#0b0f14;font-weight:700;border:none;cursor:pointer;text-decoration:none}
.button.ghost{background:transparent;border:1px solid rgba(255,255,255,.14);color:var(--text)}
input[type=file],select{padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.14);background:#0e141b;color:var(--text)}
.preview{display:flex;gap:18px;align-items:flex-start;margin-top:12px}
#img{max-width:320px;max-height:240px;border-radius:12px;border:1px solid rgba(255,255,255,.08);display:none}
#preds{flex:1;display:none}
#preds table{width:100%;border-collapse:collapse;margin-top:6px}
#preds th,#preds td{border-bottom:1px solid rgba(255,255,255,.07);padding:8px;text-align:left}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.value{font-weight:700}
footer{margin-top:auto;padding:16px;color:var(--muted);text-align:center;border-top:1px solid rgba(255,255,255,.06)}
</style>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.21.0/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@2.1.0"></script>
</head>
<body>
<header><h1>E-Waste Device Identifier</h1></header>
<main>
  <section class="card">
    <h2>Upload & Identify</h2>
    <div class="row">
      <input id="file" type="file" accept="image/*"/>
      <button id="identify" class="button">Identify</button>
      <span id="status" class="note">Ready.</span>
    </div>
    <div class="preview">
      <img id="img" alt="preview"/>
      <div id="preds">
        <div class="note">Top predictions</div>
        <table><thead><tr><th>Label</th><th>Prob</th></tr></thead><tbody id="tbody"></tbody></table>
      </div>
    </div>
    <div class="row" style="margin-top:12px">
      <label for="manual" class="note">Or pick manually</label>
      <select id="manual">
        <option value="">Select</option>
        <option value="Smartphone">Smartphone</option>
        <option value="Laptop">Laptop</option>
        <option value="Tablet">Tablet</option>
        <option value="Desktop PC">Desktop PC</option>
      </select>
      <button id="apply" class="button ghost">Apply</button>
    </div>
  </section>

  <section class="card" id="result" style="display:none">
    <h2>Device & Value</h2>
    <div class="grid2">
      <div>Device: <span id="device" class="value">—</span></div>
      <div>Original value: <span id="orig" class="value">—</span></div>
      <div>Current value: <span id="curr" class="value">—</span></div>
    </div>
  </section>
</main>
<footer>© 2025 E-Waste App</footer>

<script>
let net=null, dataUrl=null;
const file=document.getElementById("file");
const img=document.getElementById("img");
const identify=document.getElementById("identify");
const statusEl=document.getElementById("status");
const predsWrap=document.getElementById("preds");
const tbody=document.getElementById("tbody");
const manual=document.getElementById("manual");
const apply=document.getElementById("apply");
const res=document.getElementById("result");
const deviceEl=document.getElementById("device");
const origEl=document.getElementById("orig");
const currEl=document.getElementById("curr");
const values={Smartphone:["₹50,000","₹5,000"],Laptop:["₹70,000","₹15,000"],Tablet:["₹30,000","₹7,000"],"Desktop PC":["₹40,000","₹8,000"]};
function mapLabelToDevice(s){const l=s.toLowerCase();if(l.includes("laptop")||l.includes("notebook"))return"Laptop";if(l.includes("smartphone")||l.includes("cellular")||l.includes("mobile")||l.includes("telephone")||l.includes("ipod"))return"Smartphone";if(l.includes("tablet")||l.includes("ipad"))return"Tablet";if(l.includes("monitor")||l.includes("screen")||l.includes("desktop"))return"Desktop PC";return null}
function setDevice(name){const v=values[name]||values["Smartphone"];deviceEl.textContent=name;origEl.textContent=v[0];currEl.textContent=v[1];res.style.display="block"}
file.addEventListener("change",()=>{const f=file.files[0];if(!f){img.style.display="none";dataUrl=null;return}const r=new FileReader();r.onload=e=>{dataUrl=e.target.result;img.src=dataUrl;img.style.display="block"};r.readAsDataURL(f)})
identify.addEventListener("click",async()=>{if(!dataUrl){statusEl.textContent="Choose an image first.";return}try{statusEl.textContent="Loading model…";if(!net){await tf.ready();try{await tf.setBackend("webgl")}catch(e){}net=await mobilenet.load()}statusEl.textContent="Identifying…";await new Promise(r=>setTimeout(r,10));const preds=await net.classify(img);tbody.innerHTML="";predsWrap.style.display="block";preds.slice(0,3).forEach(p=>{const tr=document.createElement("tr");const td1=document.createElement("td");td1.textContent=p.className;const td2=document.createElement("td");td2.textContent=(p.probability*100).toFixed(1)+"%";tr.appendChild(td1);tr.appendChild(td2);tbody.appendChild(tr)});const top=preds[0]?.className||"";const mapped=mapLabelToDevice(top)||"Smartphone";setDevice(mapped);statusEl.textContent="Done."}catch(err){statusEl.textContent="Model failed. Use manual picker."}})
apply.addEventListener("click",()=>{if(!manual.value)return;setDevice(manual.value)})
</script>
</body>
</html>
