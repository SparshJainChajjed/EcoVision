<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Waste Detection and Recycling App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            background-color: #f4f7f9;
            font-family: 'Roboto', sans-serif;
        }
        .container {
            max-width: 900px;
        }
        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 25px;
        }
        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }
        .btn-primary:hover {
            background-color: #0069d9;
        }
        .btn-success {
            background-color: #28a745;
        }
        .btn-success:hover {
            background-color: #218838;
        }
        #preview {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #dee2e6;
        }
        #loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        .header-icon {
            font-size: 1.8rem;
            color: #007bff;
        }
        .app-footer {
            text-align: center;
            margin-top: 40px;
            color: #6c757d;
            font-size: 0.9rem;
        }
        .section-title {
            font-weight: 500;
            color: #343a40;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4"><i class="fas fa-recycle header-icon me-2"></i>E-Waste Detection and Recycling App</h1>
        <p class="text-center mb-4 lead">Simplify e-waste recycling with AI-powered detection and location-based services.</p>
        
        <div class="card" id="upload-section">
            <div class="card-body">
                <h2 class="section-title"><i class="fas fa-upload me-2"></i>Upload Your Electronic Item Image</h2>
                <input type="file" class="form-control mb-3" id="image-upload" accept="image/*">
                <img id="preview" src="" alt="Image preview" class="img-fluid" style="display: none;">
                <button class="btn btn-primary w-100" id="analyze-btn"><i class="fas fa-search me-2"></i>Analyze Image</button>
            </div>
        </div>
        
        <div id="loading" class="alert alert-info"><i class="fas fa-spinner fa-spin me-2"></i>Processing... Please wait.</div>
        
        <div class="card" id="result-section" style="display: none;">
            <div class="card-body">
                <h2 class="section-title"><i class="fas fa-info-circle me-2"></i>Analysis Results</h2>
                <p id="item-name" class="fw-bold"></p>
                <p id="original-value"></p>
                <p id="current-worth"></p>
                <button class="btn btn-success me-2" id="recycle-yes"><i class="fas fa-check me-2"></i>Proceed to Recycle</button>
                <button class="btn btn-secondary" id="recycle-no"><i class="fas fa-times me-2"></i>Cancel</button>
            </div>
        </div>
        
        <div class="card" id="recycle-section" style="display: none;">
            <div class="card-body">
                <h2 class="section-title"><i class="fas fa-recycle me-2"></i>Recycling Options</h2>
                <div class="mb-3">
                    <label for="location" class="form-label">Enter Your Location (e.g., Bangalore)</label>
                    <input type="text" class="form-control" id="location" value="Bangalore">
                </div>
                <div class="mb-3">
                    <h3 class="section-title"><i class="fas fa-hand-holding-heart me-2"></i>Free Donation via NGO</h3>
                    <p>Donate your item to NGOs for responsible recycling.</p>
                    <button class="btn btn-primary w-100" id="ngo-btn">Select Donation</button>
                </div>
                <div>
                    <h3 class="section-title"><i class="fas fa-money-bill-wave me-2"></i>Paid Recycling via Companies</h3>
                    <p>Sell your item to recycling companies for compensation.</p>
                    <button class="btn btn-primary w-100" id="company-btn">Select Paid Recycling</button>
                </div>
            </div>
        </div>
        
        <div class="card" id="guide-section" style="display: none;">
            <div class="card-body">
                <h2 class="section-title"><i class="fas fa-guide-alt me-2"></i>Next Steps</h2>
                <div id="guide-text"></div>
            </div>
        </div>
    </div>
    
    <div class="app-footer">
        <p><i class="fas fa-leaf me-2"></i>Committed to Sustainable E-Waste Management</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
    <script>
        let model;
        const electronicItems = {
            'tv': { name: 'Television', original: 40000, current: 5000 },
            'laptop': { name: 'Laptop', original: 50000, current: 10000 },
            'mouse': { name: 'Computer Mouse', original: 500, current: 100 },
            'remote': { name: 'Remote Control', original: 300, current: 50 },
            'keyboard': { name: 'Keyboard', original: 1000, current: 200 },
            'cell phone': { name: 'Mobile Phone', original: 20000, current: 5000 },
            'microwave': { name: 'Microwave Oven', original: 10000, current: 2000 },
            'oven': { name: 'Oven', original: 15000, current: 3000 },
            'toaster': { name: 'Toaster', original: 2000, current: 400 },
            'refrigerator': { name: 'Refrigerator', original: 30000, current: 6000 },
            'hair drier': { name: 'Hair Dryer', original: 1500, current: 300 },
            'tablet': { name: 'Tablet', original: 25000, current: 5000 },
            'monitor': { name: 'Computer Monitor', original: 10000, current: 2000 },
            // Values in INR for India context
        };

        async function loadModel() {
            if (!model) {
                model = await cocoSsd.load();
            }
        }

        const uploadInput = document.getElementById('image-upload');
        const previewImg = document.getElementById('preview');
        const analyzeBtn = document.getElementById('analyze-btn');
        const loadingDiv = document.getElementById('loading');
        const resultSection = document.getElementById('result-section');
        const itemNameP = document.getElementById('item-name');
        const originalValueP = document.getElementById('original-value');
        const currentWorthP = document.getElementById('current-worth');
        const recycleYes = document.getElementById('recycle-yes');
        const recycleNo = document.getElementById('recycle-no');
        const recycleSection = document.getElementById('recycle-section');
        const locationInput = document.getElementById('location');
        const ngoBtn = document.getElementById('ngo-btn');
        const companyBtn = document.getElementById('company-btn');
        const guideSection = document.getElementById('guide-section');
        const guideText = document.getElementById('guide-text');

        uploadInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const url = URL.createObjectURL(file);
                previewImg.src = url;
                previewImg.style.display = 'block';
            }
        });

        analyzeBtn.addEventListener('click', async () => {
            if (!previewImg.src) {
                alert('Please upload an image first.');
                return;
            }
            loadingDiv.style.display = 'block';
            await loadModel();
            const predictions = await model.detect(previewImg);
            loadingDiv.style.display = 'none';

            if (predictions.length === 0) {
                alert('No objects detected. Please try another image.');
                return;
            }

            const topPrediction = predictions.reduce((prev, current) => (prev.score > current.score) ? prev : current);
            const className = topPrediction.class.toLowerCase();
            const item = electronicItems[className] || { name: className.charAt(0).toUpperCase() + className.slice(1), original: 'Unknown', current: 'Unknown' };

            itemNameP.textContent = `Identified Item: ${item.name}`;
            originalValueP.textContent = `Original Value (approx.): ₹${item.original}`;
            currentWorthP.textContent = `Current Estimated Value: ₹${item.current}`;

            resultSection.style.display = 'block';
        });

        recycleYes.addEventListener('click', () => {
            resultSection.style.display = 'none';
            recycleSection.style.display = 'block';
        });

        recycleNo.addEventListener('click', () => {
            alert('Thank you for using the app.');
            resetApp();
        });

        ngoBtn.addEventListener('click', () => {
            const city = locationInput.value.trim();
            guideText.innerHTML = `
                <p>For NGO donation in ${city}:</p>
                <ul>
                    <li><strong>Saahas NGO</strong>: Contact for collection (minimum 10kg). Phone: <a href="tel:080-41689889">080-41689889</a>, Email: <a href="mailto:info@saahas.org">info@saahas.org</a>. Visit <a href="https://saahas.org/" target="_blank">saahas.org</a> for details and drop-off locations.</li>
                    <li><strong>Bal Utsav</strong>: Schedule free pickup online. Website: <a href="https://balutsav.org/epr-e-waste-collection-in-bengaluru/" target="_blank">balutsav.org</a>. Receive a recycling certificate.</li>
                    <li>Explore additional local NGOs for more options.</li>
                </ul>
            `;
            recycleSection.style.display = 'none';
            guideSection.style.display = 'block';
        });

        companyBtn.addEventListener('click', () => {
            const city = locationInput.value.trim();
            guideText.innerHTML = `
                <p>For paid recycling in ${city}:</p>
                <ul>
                    <li><strong>Zolopik Recycling</strong>: Schedule pickup and get a quote online. Website: <a href="https://zolopik.com/bangalore/" target="_blank">zolopik.com/bangalore</a>.</li>
                    <li><strong>E-Scrappy Recyclers</strong>: Call for service: <a href="tel:18005729298">1800 572 9298</a>. Website: <a href="https://escrappyrecyclers.com/" target="_blank">escrappyrecyclers.com</a>.</li>
                    <li><strong>RecycleKaro</strong>: Contact for bulk recycling. Website: <a href="https://www.recyclekaro.com/" target="_blank">recyclekaro.com</a>.</li>
                    <li>Connect directly with the service providers for arrangements.</li>
                </ul>
            `;
            recycleSection.style.display = 'none';
            guideSection.style.display = 'block';
        });

        function resetApp() {
            resultSection.style.display = 'none';
            recycleSection.style.display = 'none';
            guideSection.style.display = 'none';
            previewImg.src = '';
            previewImg.style.display = 'none';
            uploadInput.value = '';
        }
    </script>
</body>
</html>
