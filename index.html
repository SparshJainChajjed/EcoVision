<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Waste Detection and Recycling App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        #upload-section, #result-section, #recycle-section {
            margin-bottom: 20px;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #preview {
            max-width: 300px;
            max-height: 300px;
            display: block;
            margin: 10px 0;
        }
        #loading {
            display: none;
        }
    </style>
</head>
<body>
    <h1>E-Waste Detection and Recycling App</h1>
    
    <div id="upload-section">
        <h2>Upload Image of Your Old Electronic Item</h2>
        <input type="file" id="image-upload" accept="image/*">
        <img id="preview" src="" alt="Image preview" style="display: none;">
        <button id="analyze-btn">Analyze Image</button>
    </div>
    
    <div id="loading">Loading model and analyzing... Please wait.</div>
    
    <div id="result-section" style="display: none;">
        <h2>Analysis Result</h2>
        <p id="item-name"></p>
        <p id="original-value"></p>
        <p id="current-worth"></p>
        <button id="recycle-yes">Yes, I want to recycle</button>
        <button id="recycle-no">No, thanks</button>
    </div>
    
    <div id="recycle-section" style="display: none;">
        <h2>Recycling Options</h2>
        <label for="location">Enter your city (e.g., Bangalore):</label>
        <input type="text" id="location" value="Bangalore">
        <div>
            <h3>Option 1: Recycle for Free via NGO Donation</h3>
            <p>Donate to local NGOs that handle e-waste responsibly.</p>
            <button id="ngo-btn">Proceed with NGO Donation</button>
        </div>
        <div>
            <h3>Option 2: Recycle for Money through Companies</h3>
            <p>Sell to companies like Zolopik Recycling.</p>
            <button id="company-btn">Proceed with Paid Recycling</button>
        </div>
    </div>
    
    <div id="guide-section" style="display: none;">
        <h2>Guide to Proceed</h2>
        <p id="guide-text"></p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@latest"></script>
    <script>
        let model;
        const electronicItems = {
            'cell phone': { name: 'Cell Phone', original: 500, current: 50 },
            'laptop': { name: 'Laptop', original: 1000, current: 200 },
            'remote control': { name: 'Remote Control', original: 20, current: 5 },
            'mouse': { name: 'Computer Mouse', original: 30, current: 10 },
            'keyboard': { name: 'Keyboard', original: 50, current: 15 },
            // Add more electronic classes from ImageNet if needed
        };

        async function loadModel() {
            if (!model) {
                model = await mobilenet.load();
            }
        }

        const uploadInput = document.getElementById('image-upload');
        const previewImg = document.getElementById('preview');
        const analyzeBtn = document.getElementById('analyze-btn');
        const loadingDiv = document.getElementById('loading');
        const resultSection = document.getElementById('result-section');
        const itemNameP = document.getElementById('item-name');
        const originalValueP = document.getElementById('original-value');
        const currentWorthP = document.getElementById('current-worth');
        const recycleYes = document.getElementById('recycle-yes');
        const recycleNo = document.getElementById('recycle-no');
        const recycleSection = document.getElementById('recycle-section');
        const locationInput = document.getElementById('location');
        const ngoBtn = document.getElementById('ngo-btn');
        const companyBtn = document.getElementById('company-btn');
        const guideSection = document.getElementById('guide-section');
        const guideText = document.getElementById('guide-text');

        uploadInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const url = URL.createObjectURL(file);
                previewImg.src = url;
                previewImg.style.display = 'block';
            }
        });

        analyzeBtn.addEventListener('click', async () => {
            if (!previewImg.src) {
                alert('Please upload an image first.');
                return;
            }
            loadingDiv.style.display = 'block';
            await loadModel();
            const predictions = await model.classify(previewImg);
            loadingDiv.style.display = 'none';

            const topPrediction = predictions[0].className.split(',')[0].trim(); // Get first class
            const item = electronicItems[topPrediction] || { name: topPrediction, original: 'Unknown', current: 'Unknown' };

            itemNameP.textContent = `Identified Item: ${item.name}`;
            originalValueP.textContent = `Original Value: $${item.original}`;
            currentWorthP.textContent = `Approximate Current Worth: $${item.current}`;

            resultSection.style.display = 'block';
        });

        recycleYes.addEventListener('click', () => {
            resultSection.style.display = 'none';
            recycleSection.style.display = 'block';
        });

        recycleNo.addEventListener('click', () => {
            alert('Thank you for using the app!');
            resetApp();
        });

        ngoBtn.addEventListener('click', () => {
            const city = locationInput.value.trim();
            guideText.innerHTML = `For free recycling via NGO in ${city}:<br>
            - Search for local e-waste NGOs in ${city}.<br>
            - Contact them for pickup or drop-off.<br>
            - Example in Bangalore: Saahas NGO or E-Parisaraa.`;
            recycleSection.style.display = 'none';
            guideSection.style.display = 'block';
        });

        companyBtn.addEventListener('click', () => {
            const city = locationInput.value.trim();
            guideText.innerHTML = `For paid recycling in ${city}:<br>
            - Contact companies like Zolopik Recycling.<br>
            - Schedule a pickup or visit their center.<br>
            - They will evaluate and pay based on the item condition.<br>
            - Website: https://zolopik.com (check for availability in ${city}).`;
            recycleSection.style.display = 'none';
            guideSection.style.display = 'block';
        });

        function resetApp() {
            resultSection.style.display = 'none';
            recycleSection.style.display = 'none';
            guideSection.style.display = 'none';
            previewImg.src = '';
            previewImg.style.display = 'none';
            uploadInput.value = '';
        }
    </script>
</body>
</html>
