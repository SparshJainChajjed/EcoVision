<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>E-Waste Image Classifier (one-file, CDN only)</title>

  <!-- 1️⃣  TensorFlow.js core -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.21.0/dist/tf.min.js"></script>
  <!-- 2️⃣  MobileNet-v2 UMD bundle -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@2.1.0/dist/mobilenet.min.js"></script>

  <style>
    body {font-family:sans-serif;text-align:center;padding:2rem;}
    img  {max-width:100%;margin-top:1rem;}
    #out {margin-top:1rem;font-size:1.2rem;white-space:pre-wrap;}
  </style>
</head>
<body>
  <h1>E-Waste Image Classifier</h1>
  <p>Upload one gadget photo (phone, laptop, remote…)</p>

  <input type="file" id="pick" accept="image/*"><br>
  <img id="preview" alt="Preview">
  <div id="out">Loading model … (first load ≈ 5 MB)</div>

  <script>
    (async () => {
      try {
        const model = await mobilenet.load();                  // download once
        document.getElementById('out').textContent =
          'Model ready – choose an image.';

        document.getElementById('pick').onchange = async e => {
          const file = e.target.files[0];
          if (!file) return;

          const img = document.getElementById('preview');
          img.src = URL.createObjectURL(file);
          await img.decode();

          document.getElementById('out').textContent = 'Classifying…';
          const preds = await model.classify(img, 3);

          document.getElementById('out').textContent =
            preds.map(p =>
              `${p.className} — ${(p.probability*100).toFixed(1)} %`
            ).join('\n');
        };
      } catch (err) {
        console.error(err);
        document.getElementById('out').textContent =
          '⚠️  Model failed to load (check internet or ad-blocker).';
      }
    })();
  </script>
</body>
</html>
